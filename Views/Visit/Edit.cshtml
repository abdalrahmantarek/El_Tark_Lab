@using LAB.ViewModel;
@model VisitViewModel

<!--begin::Modal content-->
<div class=" card">
	<!--begin::Modal header-->
	<div class="modal-header">
		<!--begin::Modal title-->
		<h2>Create Visit</h2>
		<!--end::Modal title-->
		<!--begin::Close-->
		<div class="btn btn-sm btn-icon btn-active-color-primary" data-bs-dismiss="modal">
			<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
			<span class="svg-icon svg-icon-1">
				<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor" />
					<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor" />
				</svg>
			</span>
			<!--end::Svg Icon-->
		</div>
		<!--end::Close-->
	</div>
	<!--end::Modal header-->
	<!--begin::Modal body-->
	<div class=" py-lg-10 px-lg-10 card-body">
		<!--begin::Stepper-->
		<div class="stepper stepper-pills stepper-column d-flex flex-column flex-xl-row flex-row-fluid" id="kt_modal_create_app_stepper">
			<!--begin::Aside-->
			<div class="d-flex justify-content-center justify-content-xl-start flex-row-auto w-100 w-xl-300px">
				<!--begin::Nav-->
				<div class="stepper-nav ps-lg-10">
					<!--begin::Step 1-->
					<div class="stepper-item current" data-kt-stepper-element="nav">
						<!--begin::Wrapper-->
						<div class="stepper-wrapper">
							<!--begin::Icon-->
							<div class="stepper-icon w-40px h-40px">
								<i class="stepper-check fas fa-check"></i>
								<span class="stepper-number">1</span>
							</div>
							<!--end::Icon-->
							<!--begin::Label-->
							<div class="stepper-label">
								<h3 class="stepper-title">Details</h3>
								<div class="stepper-desc">New Visit</div>
							</div>
							<!--end::Label-->
						</div>
						<!--end::Wrapper-->
						<!--begin::Line-->
						<div class="stepper-line h-40px"></div>
						<!--end::Line-->
					</div>
					<!--end::Step 1-->
					<!--begin::Step 2-->
					<div class="stepper-item" data-kt-stepper-element="nav">
						<!--begin::Wrapper-->
						<div class="stepper-wrapper">
							<!--begin::Icon-->
							<div class="stepper-icon w-40px h-40px">
								<i class="stepper-check fas fa-check"></i>
								<span class="stepper-number">2</span>
							</div>
							<!--begin::Icon-->
							<!--begin::Label-->
							<div class="stepper-label">
								<h3 class="stepper-title">Visit Insured</h3>
								<div class="stepper-desc">Insured Data</div>
							</div>
							<!--begin::Label-->
						</div>
						<!--end::Wrapper-->
						<!--begin::Line-->
						<div class="stepper-line h-40px"></div>
						<!--end::Line-->
					</div>
					<!--end::Step 2-->
					<!--begin::Step 4-->
					<div class="stepper-item" data-kt-stepper-element="nav">
						<!--begin::Wrapper-->
						<div class="stepper-wrapper">
							<!--begin::Icon-->
							<div class="stepper-icon w-40px h-40px">
								<i class="stepper-check fas fa-check"></i>
								<span class="stepper-number">4</span>
							</div>
							<!--end::Icon-->
							<!--begin::Label-->
							<div class="stepper-label">
								<h3 class="stepper-title">Services</h3>
								<div class="stepper-desc">Select Services</div>
							</div>
							<!--end::Label-->
						</div>
						<!--end::Wrapper-->
						<!--begin::Line-->
						<div class="stepper-line h-40px"></div>
						<!--end::Line-->
					</div>
					<!--end::Step 4-->
				</div>
				<!--end::Nav-->
			</div>
			<!--begin::Aside-->
			<!--begin::Content-->
			<div class="flex-row-fluid py-lg-5 px-lg-15">
				<!--begin::Form-->
				<form class="form" asp-action="Edit" method="post" id="kt_modal_create_app_form">
					<!--begin::Step 1-->
					<div class="current" data-kt-stepper-element="content">
						<div class="w-100">
							<div class="row">
								<!--begin::Input group : patient Name-->
								<div class="fv-row mb-10 col-6">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Patient Name</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label-->
									<!--begin::Input-->
									<!--begin::Select2-->
									<select data-control="select2" required data-placeholder="Select Patient" id="patientSelect" asp-for="@Model.Visit.PatientId" class="form-control required">
										<option value=""></option>
										<option value="add-patient">Add Patient</option>
										@foreach (var item in Model.Patients)
										{
											<option value="@item.PatientId">@item.PatientName</option>
										}
									</select>

									<span class="text-danger" asp-validation-for="@Model.Visit.PatientId"></span>
									<!--end::Select2-->
									<!--end::Input-->
								</div>
								<!--end::Input group-->
								<!--begin::Input group : RefererDoctor-->
								<div class="fv-row mb-10 col-6">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required"> Referer Doctor</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label-->
									<!--begin::Input-->
									<!--begin::Select2-->
									<select asp-for="@Model.Visit.RefererDoctor" id="addrefdocSelect" class="form-select" data-control="select2" data-placeholder="Select Referer Doctor">
										<option></option>
										<option value="add-refdoc">Add Reffered Doctor</option>
										@foreach (var item in Model.RefDoctor)
										{

											<option value="@item.DrId">@item.DoctorName</option>
										}
									</select>
									<span class="text-danger" asp-validation-for="@Model.Visit.RefererDoctor"></span>
									<!--end::Select2-->
									<!--end::Input-->
								</div>
								<!--end::Input group-->
							</div>
							<!--begin::Input group : StartDate-->

							<div class="row d-none">
								<div class="fv-row mb-10 col-6">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Start Date</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label-->
									<!--begin::Input-->
									<input asp-for="@Model.Visit.VisitStartDate" required class="form-control" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
								<!--begin::Input group : EneDate-->
								<div class="fv-row mb-10 col-6">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">End Date</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label  -->
									<!--begin::Input-->
									<input asp-for="@Model.Visit.VisitEndDate" class="form-control" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
							</div>
							<!--begin::Input group : VisitStatus-->
							<div class="fv-row mb-10">
								<!--begin::Label-->
								<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
									<span class="required">VisitStatus</span>
									<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
								</label>
								<!--begin::Input group-->
								<select asp-for="@Model.Visit.VisitStatus" data-control="select2" class="form-control">
									<option value="P">pending</option>
									<option value="N">New</option>
									<option value="A">Active</option>
									<option value="E">Ended</option>
									<option value="C">Canceled</option>
								</select>
								<span class="text-danger" asp-validation-for="@Model.Visit.VisitStatus"></span>
							</div>
							<!--end::Input group-->
							<!--begin::Input group : VisitInsurred-->
							<div class="fv-row mb-10">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" asp-for="@Model.Visit.VisitInsurred" id="flexSwitchCheckDefault">
									<label class="form-check-label" for="flexSwitchCheckDefault">Visit Insured?</label>
								</div>
							</div>
							<!--end::Input group-->

						</div>
						<!-- Modal for adding a patient -->


					</div>
					<!--end::Step 1-->
					<!--begin::Step 2-->
					<div data-kt-stepper-element="content">
						<div class="w-100">
							<!--VisitInsurredCompanyId & InssuredExpireDate -->
							<div class="row">
								<!--begin::Input group : VisitInsurredCompanyId-->
								<div class="fv-row mb-10 col-6" id="insuredCompanyInput" style="display: none;">
									<!-- Label and input field for VisitInsurredCompanyId -->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Visit Insured CompanyId</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<select data-control="select2" required data-placeholder="Select Vendor" id="vendorData" asp-for="@Model.Visit.VisitInsurredCompanyId" class="form-control ">
										@foreach (var item in Model.Vendors)
										{
											<option value="@item.VendorId">@item.VendorName </option>
										}
									</select>
								</div>
								<!--end::Input group-->
								<!-- hidden fields-->
								<input type="hidden" asp-for="@Model.Visit.VisitType" class="form-control" />
								<input type="hidden" asp-for="@Model.Visit.LastUpdateDate" class="form-control" />
								<input type="hidden" asp-for="@Model.Visit.LastUpdateFrom" class="form-control" />
								<input type="hidden" asp-for="@Model.Visit.LastUpdateBy" class="form-control" />

								<!--begin::Input group : InssuredExpireDate-->
								<div class="fv-row mb-10 col-6" style="display: none;" id="InssuredExpireDate">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Inssured Expire Date</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label-->
									<!--begin::Input-->
									<input asp-for="@Model.Visit.InssuredExpireDate" class="form-control" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
							</div>
							<!--begin::Input group : DiscountCard-->
							<div class="fv-row mb-10" id="DiscountCard">
								<!--begin::Label-->
								<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
									<span class="required">DiscountCard</span>
									<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
								</label>
								<!--end::Label-->
								<!--begin::Input-->
								<input asp-for="@Model.Visit.DiscountCard" class="form-control" />
								<!--end::Input-->
							</div>
							<!--end::Input group-->
							<div class="row">
								<!--begin::Input group : Copayment-->
								<div class="fv-row mt-5 mb-10 col-6" id="CopaymentInput" style="display: none;">
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Copayment</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<input type="number" min="0" max="100" asp-for="@Model.Visit.Copayment" class="form-control" />
								</div>
								<!--end::Input group-->
								<!--begin::Input group : PatientInssurredId-->
								<div class="fv-row mt-5 mb-10 col-6" style="display: none;" id="PatientInssurredId">
									<!--begin::Label-->
									<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
										<span class="required">Patient Inssurred ID</span>
										<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
									</label>
									<!--end::Label-->
									<!--begin::Input-->
									<input asp-for="@Model.Visit.PatientInssurredId" class="form-control" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
								<!--PatientApprovalNum & ApprovalMaxLimit -->
								<div class="row">
									<!--begin::Input group : PatientApprovalNum-->
									<div class="fv-row mb-10 col-6" style="display: none;" id="PatientApprovalNum">
										<!--begin::Label-->
										<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
											<span class="required">Patient Approval Num</span>
											<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
										</label>
										<!--end::Label-->
										<!--begin::Input-->
										<input asp-for="@Model.Visit.PatientApprovalNum" class="form-control" />
										<!--end::Input-->
									</div>
									<!--end::Input group-->
									<!--begin::Input group : ApprovalMaxLimit-->
									<div class="fv-row mb-10 col-6" style="display: none;" id="ApprovalMaxLimit">
										<!--begin::Label-->
										<label class="d-flex align-items-center fs-5 fw-semibold mb-2">
											<span class="required">Approval Max Limit</span>
											<i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Specify your unique app name"></i>
										</label>
										<!--end::Label-->
										<!--begin::Input-->
										<input asp-for="@Model.Visit.ApprovalMaxLimit" class="form-control" />
										<!--end::Input-->
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--end::Step 2-->
					<!--begin::Step 4-->
					<div data-kt-stepper-element="content">
						<div class="w-100">
							<!--begin::Main column-->
							<div class="d-flex flex-column flex-lg-row-fluid gap-7 gap-lg-10">
								<!--begin::Order details-->
								<div class="card card-flush py-4">
									<!--begin::Card header-->
									<div class="card-header">
										<div class="card-title">
											<h2>Select Services</h2>
										</div>
									</div>
									<!--end::Card header-->
									<!--begin::Card body-->
									<div class="card-body pt-0" id="SPLTable">
										<div class="d-flex flex-column gap-10">
											<!--begin::Input group-->
											<div>
												<!--begin::Label-->
												<label class="form-label">Add Services to this Visit</label>
												<!--end::Label-->
												<!--begin::Selected products-->
												<div class="row row-cols-1 row-cols-xl-3 row-cols-md-2 border border-dashed rounded pt-3 pb-1 px-2 mb-5 mh-300px overflow-scroll" id="kt_ecommerce_edit_order_selected_products">
													<!--begin::Empty message-->
													<span class="w-100 text-muted">Select one or more Service from the list below by ticking the checkbox.</span>
													<!--end::Empty message-->
												</div>
												<!--begin::Selected products-->
												<!--begin::Total price-->
												<div class="fw-bold fs-4">
													Total Cost: $
													<span id="kt_ecommerce_edit_order_total_price">0.00</span>
												</div>
												<!--end::Total price-->
											</div>
											<!--end::Input group-->
											<!--begin::Separator-->
											<div class="separator"></div>
											<!--end::Separator-->
											<!--begin::Search products-->
											<div class="d-flex align-items-center position-relative mb-n7">
												<!--begin::Svg Icon | path: icons/duotune/general/gen021.svg-->
												<span class="svg-icon svg-icon-1 position-absolute ms-4">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor" />
														<path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor" />
													</svg>
												</span>
												<!--end::Svg Icon-->
												<input type="text" data-kt-ecommerce-edit-order-filter="search" class="form-control form-control-solid w-100 w-lg-50 ps-14" placeholder="Search Products" />
											</div>
											<!--end::Search products-->
											<!--begin::Table-->
											<table class="table align-middle table-row-dashed fs-6 gy-5" id="kt_ecommerce_edit_order_product_table">
												<!--begin::Table head-->
												<thead>
													<tr class="text-start text-gray-400 fw-bold fs-7 text-uppercase gs-0">
														<th class="w-25px pe-2"></th>
														<th class="min-w-200px">Service</th>
														<th class="min-w-150px">Lab to Lab</th>
														<th class="min-w-100px text-end pe-5">Discount</th>
													</tr>
												</thead>
												<!--end::Table head-->
												<!--begin::Table body-->
												<tbody class="fw-semibold text-gray-600">
													<!--begin::Table row-->
													@for (int i = 0; i < Model.ServicesPricelists.Count; i++)
													{

														<tr>
															<!--begin::Checkbox-->
															<td>
																<div class="form-check form-check-sm form-check-custom form-check-solid">
																	<input class="form-check-input SelectedServices" name="VisitserviceViewModel[@i].SelectedServices" type="checkbox" value="@Model.ServicesPricelists[@i].ServiceId" />

																</div>

															</td>
															<!--end::Checkbox-->
															<!--begin::Product=-->
															<td>
																<div class="d-flex align-items-center" data-kt-ecommerce-edit-order-filter="product" data-kt-ecommerce-edit-order-id="product_1">
																	<!--begin::Thumbnail-->
																	<a class="symbol symbol-50px">

																	</a>
																	<!--end::Thumbnail-->
																	<div class="ms-5">
																		<!--begin::Title-->
																		<a class="text-gray-800 text-hover-primary fs-5 fw-bold">@Model.ServicesPricelists[@i].ServiceName</a>
																		<!--end::Title-->
																		<!--begin::Price-->
																		<div class="fw-semibold fs-7">
																			Price: $
																			<span data-kt-ecommerce-edit-order-filter="price">@Model.ServicesPricelists[@i].ServicePrice</span>
																		</div>
																		<!--end::Price-->
																		<!--begin::SKU-->
																		<div class="text-muted fs-7">SKU: 04953004</div>
																		<!--end::SKU-->
																	</div>
																</div>
															</td>
															<!--end::Product=-->
															<td>
																<select disabled name="VisitserviceViewModel[@i].SelectedServicesLab2Lab" data-control="select2" data-placeholder="Select Lab" class="form-control SelectedServicesLab2Lab">
																	<option value="0">Select Lab</option>
																	@foreach (var vendor in Model.L2LVendor)
																	{
																		<option value="@vendor.VendorId">@vendor.VendorName</option>
																	}
																</select>
															</td>
															<!--begin: Discount=-->
															<td class="text-end pe-5" data-order="28">
																<input disabled class="form-control SelectedServicesDiscount" type="number" value="0" min="0" max="100" name="VisitserviceViewModel[@i].SelectedServicesDiscount">
															</td>
															<!--end: Discount=-->
														</tr>
													}

												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
									</div>
									<!--end::Card header-->
								</div>
								<!--end::Order details-->
								<!--begin::Order details-->
								<div class="card card-flush py-4">
									<!--begin::Card header-->
									<!--end::Card header-->
									<!--begin::Card body-->
									<div class="card-body pt-0">
										<!--begin::Billing address-->
										<div class="d-flex flex-column gap-5 gap-md-7">

											<!--begin::Checkbox-->
											<div hidden class="form-check form-check-custom form-check-solid">
												<input class="form-check-input" type="checkbox" value="" id="same_as_billing" checked="checked" />
											</div>
											<!--end::Checkbox-->

										</div>
										<!--end::Billing address-->
									</div>
									<!--end::Card body-->
								</div>
								<!--end::Order details-->

							</div>
							<!--end::Main column-->
						</div>
					</div>
					<!--end::Step 4-->
					<!--begin::Actions-->
					<div class="d-flex flex-stack pt-10">
						<!--begin::Wrapper-->
						<div class="me-2">
							<button type="submit" class="btn btn-lg btn-light-primary me-3" data-kt-stepper-action="previous">
								<!--begin::Svg Icon | path: icons/duotune/arrows/arr063.svg-->
								<span class="svg-icon svg-icon-3 me-1">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<rect opacity="0.5" x="6" y="11" width="13" height="2" rx="1" fill="currentColor" />
										<path d="M8.56569 11.4343L12.75 7.25C13.1642 6.83579 13.1642 6.16421 12.75 5.75C12.3358 5.33579 11.6642 5.33579 11.25 5.75L5.70711 11.2929C5.31658 11.6834 5.31658 12.3166 5.70711 12.7071L11.25 18.25C11.6642 18.6642 12.3358 18.6642 12.75 18.25C13.1642 17.8358 13.1642 17.1642 12.75 16.75L8.56569 12.5657C8.25327 12.2533 8.25327 11.7467 8.56569 11.4343Z" fill="currentColor" />
									</svg>
								</span>
								<!--end::Svg Icon-->Back
							</button>
						</div>
						<!--end::Wrapper-->
						<!--begin::Wrapper-->
						<div>
							<button type="submit" class="btn btn-lg btn-primary" id="btn_submit" data-kt-stepper-action="submit">
								<span class="indicator-label">
									Submit
									<!--begin::Svg Icon | path: icons/duotune/arrows/arr064.svg-->
									<span class="svg-icon svg-icon-3 ms-2 me-0">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
											<rect opacity="0.5" x="18" y="13" width="13" height="2" rx="1" transform="rotate(-180 18 13)" fill="currentColor" />
											<path d="M15.4343 12.5657L11.25 16.75C10.8358 17.1642 10.8358 17.8358 11.25 18.25C11.6642 18.6642 12.3358 18.6642 12.75 18.25L18.2929 12.7071C18.6834 12.3166 18.6834 11.6834 18.2929 11.2929L12.75 5.75C12.3358 5.33579 11.6642 5.33579 11.25 5.75C10.8358 6.16421 10.8358 6.83579 11.25 7.25L15.4343 11.4343C15.7467 11.7467 15.7467 12.2533 15.4343 12.5657Z" fill="currentColor" />
										</svg>
									</span>
									<!--end::Svg Icon-->
								</span>
								<span class="indicator-progress">
									Please wait...
									<span class="spinner-border spinner-border-sm align-middle ms-2"></span>
								</span>
							</button>
							<button type="button" class="btn btn-lg btn-primary" data-kt-stepper-action="next">
								Continue
								<!--begin::Svg Icon | path: icons/duotune/arrows/arr064.svg-->
								<span class="svg-icon svg-icon-3 ms-1 me-0">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<rect opacity="0.5" x="18" y="13" width="13" height="2" rx="1" transform="rotate(-180 18 13)" fill="currentColor" />
										<path d="M15.4343 12.5657L11.25 16.75C10.8358 17.1642 10.8358 17.8358 11.25 18.25C11.6642 18.6642 12.3358 18.6642 12.75 18.25L18.2929 12.7071C18.6834 12.3166 18.6834 11.6834 18.2929 11.2929L12.75 5.75C12.3358 5.33579 11.6642 5.33579 11.25 5.75C10.8358 6.16421 10.8358 6.83579 11.25 7.25L15.4343 11.4343C15.7467 11.7467 15.7467 12.2533 15.4343 12.5657Z" fill="currentColor" />
									</svg>
								</span>
								<!--end::Svg Icon-->
							</button>
						</div>
						<!--end::Wrapper-->
					</div>
					<!--end::Actions-->
				</form>
				<!--end::Form-->
				<!--begin::Modal - Patient - Add-->
				<div class="modal fade" id="addPatientModal" tabindex="-1" role="dialog" aria-labelledby="addPatientModalLabel" aria-hidden="true">
					<!--begin::Modal dialog-->
					<div class="modal-dialog modal-dialog-centered mw-650px">
						<!--begin::Modal content-->
						<div id="addPatientModal" class="modal-content">

							<!--begin::Form-->
							<form class="form fv-plugins-bootstrap5 fv-plugins-framework" method="post" asp-controller="Patient" asp-action="AddPatientInVisitView">


								<!--begin::Modal header-->
								<div class="modal-header">
									<!--begin::Modal title-->
									<h2 class="fw-bold">Add a Patient</h2>
									<!--end::Modal title-->
									<!--begin::Close-->
									<div id="kt_modal_add_customer_close" class="btn btn-icon btn-sm btn-active-icon-primary">
										<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
										<span class="svg-icon svg-icon-1">
											<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
												<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor"></rect>
												<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor"></rect>
											</svg>
										</span>
										<!--end::Svg Icon-->
									</div>
									<!--end::Close-->
								</div>
								<!--end::Modal header-->
								<!--begin::Modal body-->
								<div class="modal-body py-10 px-lg-17">
									<!--begin::Scroll-->
									<div class="scroll-y me-n7 pe-7" id="kt_modal_add_customer_scroll" data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto" data-kt-scroll-dependencies="#kt_modal_add_customer_header" data-kt-scroll-wrappers="#kt_modal_add_customer_scroll" data-kt-scroll-offset="300px" style="max-height: 490px;">
										<!--begin::Input group-->
										<div class="fv-row mb-7 fv-plugins-icon-container">
											<!--begin::Label-->
											<label class="required fs-6 fw-semibold mb-2">PatientName</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" class="form-control form-control-solid" required placeholder="" name="PatientName" value="">
											<!--end::Input-->
											<div class="fv-plugins-message-container invalid-feedback"></div>
										</div>
										<!--end::Input group-->
										<!--begin::Input group-->
										<div class="fv-row mb-7 fv-plugins-icon-container">
											<!--begin::Label-->
											<label class="fs-6 fw-semibold mb-2">
												<span class="required">PatientEmail</span>
												<i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" aria-label="Email address must be active" data-bs-original-title="Email address must be active" data-kt-initialized="1"></i>
											</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="email" class="form-control form-control-solid" placeholder="" name="PatientEmail" value="">
											<!--end::Input-->
											<div class="fv-plugins-message-container invalid-feedback"></div>
										</div>
										<!--end::Input group-->
										<!--begin::Input group-->
										<div class="fv-row mb-15">
											<!--begin::Label-->
											<label class="fs-6 fw-semibold mb-2">PatientNidType</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" class="form-control form-control-solid" placeholder="" name="PatientNidType" value="">
											<!--end::Input-->
										</div>
										<!--end::Input group-->
										<!--begin::Billing toggle-->
										<div class="fw-bold fs-3 rotate collapsible mb-7" data-bs-toggle="collapse" href="#kt_modal_add_customer_billing_info" role="button" aria-expanded="false" aria-controls="kt_customer_view_details">
											Patient Information
											<span class="ms-2 rotate-180">
												<!--begin::Svg Icon | path: icons/duotune/arrows/arr072.svg-->
												<span class="svg-icon svg-icon-3">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<path d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z" fill="currentColor"></path>
													</svg>
												</span>
												<!--end::Svg Icon-->
											</span>
										</div>
										<!--end::Billing toggle-->
										<!--begin::Billing form-->
										<div id="kt_modal_add_customer_billing_info" class="collapse show">
											<!--begin::Input group-->
											<div class="d-flex flex-column mb-7 fv-row fv-plugins-icon-container">
												<!--begin::Label-->
												<label class="required fs-6 fw-semibold mb-2">Address</label>
												<!--end::Label-->
												<!--begin::Input-->
												<input type="text" class="form-control form-control-solid" placeholder="" name="PatientAddress" value="">
												<!--end::Input-->
												<div class="fv-plugins-message-container invalid-feedback"></div>
											</div>
											<!--end::Input group-->
											<!--begin::Input group-->
											<div class="d-flex flex-column mb-7 fv-row">
												<!--begin::Label-->
												<label class="fs-6 fw-semibold mb-2">Gender</label>
												<!--end::Label-->
												<!--begin::Input-->
												<select name="PatientGender" class=" form-control">
													<option value="M">Male</option>
													<option value="F">Female</option>
												</select>

												<!--end::Input-->
											</div>
											<!--end::Input group-->
											<!--begin::Input group-->
											<div class="d-flex flex-column mb-7 fv-row fv-plugins-icon-container">
												<!--begin::Label-->
												<label class="required fs-6 fw-semibold mb-2">patientNID</label>
												<!--end::Label-->
												<!--begin::Input-->
												<input class="form-control form-control-solid" placeholder="" name="PatientNid" value="">
												<!--end::Input-->
												<div class="fv-plugins-message-container invalid-feedback"></div>
											</div>
											<!--end::Input group-->
											<!--begin::Input group-->
											<div class="row g-9 mb-7">
												<!--begin::Col-->
												<div class="col-md-6 fv-row fv-plugins-icon-container">
													<!--begin::Label-->
													<label class="required fs-6 fw-semibold mb-2">Phone 1</label>
													<!--end::Label-->
													<!--begin::Input-->
													<input type="text" class="form-control form-control-solid" placeholder="" name="PatientTel1" value="">
													<!--end::Input-->
													<div class="fv-plugins-message-container invalid-feedback"></div>
												</div>
												<!--end::Col-->
												<!--begin::Col-->
												<div class="col-md-6 fv-row fv-plugins-icon-container">
													<!--begin::Label-->
													<label class="required fs-6 fw-semibold mb-2">phone 2</label>
													<!--end::Label-->
													<!--begin::Input-->
													<input type="text" class="form-control form-control-solid" placeholder="" name="PatientTel2" value="">
													<!--end::Input-->
													<div class="fv-plugins-message-container invalid-feedback"></div>
												</div>
												<!--end::Col-->
											</div>
											<!--end::Input group-->
											<!--begin::Input group-->
											<div class="d-flex flex-column mb-7 fv-row fv-plugins-icon-container">
												<!--begin::Label-->
												<label class="fs-6 fw-semibold mb-2">
													<span class="required">Country</span>
													<i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" aria-label="Country of origination" data-bs-original-title="Country of origination" data-kt-initialized="1"></i>
												</label>
												<!--end::Label-->
												<!--begin::Input-->
												<input type="text" class="form-control form-control-solid" placeholder="" name="PatientCountry" value="">
												<!--end::Input-->
												<div class="fv-plugins-message-container invalid-feedback"></div>
											</div>
											<!--end::Input group-->
											<div class="d-flex flex-column mb-7 fv-row fv-plugins-icon-container">
												<!--begin::Label-->
												<label class="fs-6 fw-semibold mb-2">
													<span class="required">BirthDate</span>
													<i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" aria-label="Country of origination" data-bs-original-title="Country of origination" data-kt-initialized="1"></i>
												</label>
												<!--end::Label-->
												<!--begin::Input-->
												<input type="date" class="form-control form-control-solid" placeholder="" name="PatientBirthdate" value="">
												<!--end::Input-->
												<div class="fv-plugins-message-container invalid-feedback"></div>
											</div>

										</div>
										<!--end::Billing form-->
									</div>
									<!--end::Scroll-->
								</div>
								<!--end::Modal body-->
								<!--begin::Modal footer-->
								<div class="modal-footer flex-center">
									<!--begin::Button-->
									<button type="reset" id="kt_modal_add_customer_cancel" class="btn btn-light me-3">Discard</button>
									<!--end::Button-->
									<!--begin::Button-->
									<button type="submit" class="btn btn-primary">
										<span class="indicator-label">Submit</span>
										<span class="indicator-progress">
											Please wait...
											<span class="spinner-border spinner-border-sm align-middle ms-2"></span>
										</span>
									</button>
									<!--end::Button-->
								</div>
								<!--end::Modal footer-->
							</form>
						</div>
					</div>
				</div>
				<!--end::Modal - Patient - Add-->
				<!--begin::Modal - add - reff doc -->
				<div class="modal fade" id="addrefdoc" tabindex="-1" role="dialog" aria-labelledby="addPatientModalLabel" aria-hidden="true">
					<!--begin::Modal dialog-->
					<div class="modal-dialog modal-dialog-centered mw-650px">
						<!--begin::Modal content-->
						<div class="modal-content">
							<!--begin::Form-->
							<form class="form" asp-controller="RefferedDoctor" asp-action="AddInVisitView" id="kt_modal_add_customer_form" method="post">
								<!--begin::Modal header-->
								<div class="modal-header" id="kt_modal_add_customer_header">
									<!--begin::Modal title-->
									<h2 class="fw-bold">Add Doctor</h2>
									<!--end::Modal title-->
									<!--begin::Close-->
									<div id="kt_modal_add_customer_close" class="btn btn-icon btn-sm btn-active-icon-primary">
										<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
										<span class="svg-icon svg-icon-1">
											<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
												<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor" />
												<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor" />
											</svg>

										</span>
										<!--end::Svg Icon-->
									</div>
									<!--end::Close-->
								</div>
								<!--end::Modal header-->
								<!--begin::Modal body-->
								<div class="modal-body py-10 px-lg-17">
									<!--begin::Scroll-->
									<div class="scroll-y me-n7 pe-7" id="kt_modal_add_customer_scroll" data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto" data-kt-scroll-dependencies="#kt_modal_add_customer_header" data-kt-scroll-wrappers="#kt_modal_add_customer_scroll" data-kt-scroll-offset="300px">
										<!--begin::Input group-->
										<div class="fv-row mb-7">
											<!--begin::Label-->
											<label class="required fs-6 fw-semibold mb-2">Doctor Name</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" required class="form-control form-control-solid" placeholder="Enter Doctor Name" name="DoctorName" value="" />
											<!--end::Input-->
										</div>
										<!--end::Input group-->
										<!--begin::Input group-->
										<div class="fv-row mb-7">
											<!--begin::Label-->
											<label class="required fs-6 fw-semibold mb-2">DoctorSpecialization</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" class="form-control form-control-solid" placeholder="Enter DoctorSpecialization" name="DoctorSpecialization" value="" />
											<!--end::Input-->
										</div>
										<!--end::Input group-->
										<!--begin::Input group-->

										<div class="fv-row mb-7">
											<!--begin::Label-->
											<label class="required fs-6 fw-semibold mb-2">PhoneNumber</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" class="form-control form-control-solid" placeholder="Enter PhoneNumber" name="PhoneNumber" value="" />
											<!--end::Input-->
										</div>

										<div class="fv-row mb-7">
											<!--begin::Label-->
											<label class="required fs-6 fw-semibold mb-2">ClinicAddress</label>
											<!--end::Label-->
											<!--begin::Input-->
											<input type="text" class="form-control form-control-solid" placeholder="Enter ClinicAddress" name="ClinicAddress" value="" />
											<!--end::Input-->
										</div>
										<!--end::Input group-->

									</div>
									<!--end::Scroll-->
								</div>
								<!--end::Modal body-->
								<!--begin::Modal footer-->
								<div class="modal-footer flex-center">
									<!--begin::Button-->
									<!--begin::Button-->
									<button type="reset" id="kt_modal_add_customer_discard" class="btn btn-light me-3">Discard</button>
									<!--end::Button-->
									<!--end::Button-->
									<!--begin::Button-->
									<button type="submit" id="kt_modal_add_customer_submit" class="btn btn-primary">
										<span class="indicator-label">Submit</span>
										<span class="indicator-progress">
											Please wait...
											<span class="spinner-border spinner-border-sm align-middle ms-2"></span>
										</span>
									</button>
									<!--end::Button-->
								</div>
								<!--end::Modal footer-->
							</form>
							<!--end::Form-->
						</div>
					</div>
				</div>
				<!--end::Modal - add - reff doc-->
			</div>
			<!--end::Content-->
		</div>
		<!--end::Stepper-->
	</div>
	<!--end::Modal body-->
</div>
<!--end::Modal content-->


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Add the "Discard" button to your modal -->
<!--Attach a click event handler to the "Discard" button-->
<script>
	var discardButton = document.getElementById('kt_modal_add_customer_cancel');

	// Attach a click event handler to the "Discard" button
	discardButton.addEventListener('click', function (event) {
		// Display a confirmation dialog using Swal
		Swal.fire({
			icon: 'warning',
			title: 'Are you sure?',
			text: 'Are you sure you want to discard the form?',
			showCancelButton: true,
			confirmButtonText: 'Yes, discard it',
			cancelButtonText: 'No, cancel',
		}).then((result) => {
			if (result.isConfirmed) {
				// If the user confirms, reset the form and close the modal
				document.getElementById('kt_modal_create_app_form').reset();
				$('#addPatientModal').modal('hide'); // Close the modal
			}
		});

		// Prevent the default form submission
		event.preventDefault();
	});
</script>
<!--Attach a click event handler to the "Discard" button-->
<script>
	var discardButton = document.getElementById('kt_modal_add_customer_discard');

	// Attach a click event handler to the "Discard" button
	discardButton.addEventListener('click', function (event) {
		// Display a confirmation dialog using Swal
		Swal.fire({
			icon: 'warning',
			title: 'Are you sure?',
			text: 'Are you sure you want to discard the form?',
			showCancelButton: true,
			confirmButtonText: 'Yes, discard it',
			cancelButtonText: 'No, cancel',
		}).then((result) => {
			if (result.isConfirmed) {
				// If the user confirms, reset the form and close the modal
				document.getElementById('kt_modal_add_customer_form').reset();
				$('#addrefdoc').modal('hide'); // Close the modal
			}
		});

		// Prevent the default form submission
		event.preventDefault();
	});
</script>

<script>
	$(document).ready(function () {
		$("#patientSelect").change(function () {
			if ($(this).val() === "add-patient") {

				$("#addPatientModal").modal("show");
			}
		});
	});
</script>

<script>
	$(document).ready(function () {
		$("#addrefdocSelect").change(function () {
			if ($(this).val() === "add-refdoc") {
				$("#addrefdoc").modal("show");
			}
		});
	});
</script>

<script>


	// Select checkboxes with a class starting with 'SelectedServices'
	$("input[class^='form-check-input SelectedServices']").change(function () {
		var $row = $(this).closest("tr");
		var $select = $row.find("select[class^='form-control SelectedServicesLab2Lab']");
		var $input = $row.find("input[class^='form-control SelectedServicesDiscount']");

		if (this.checked) {
			$select.prop("disabled", false);
			$input.prop("disabled", false);
		} else {
			$select.prop("disabled", true).val(0);
			$input.prop("disabled", true).val('');
		}
	});

</script>


<script>
	// Get references to the checkbox and the input wrapper
	const checkbox = document.getElementById("flexSwitchCheckDefault");
	const insuredCompanyInput = document.getElementById("insuredCompanyInput");
	const CopaymentInput = document.getElementById("CopaymentInput");
	const PatientInssurredId = document.getElementById("PatientInssurredId")
	const PatientApprovalNum = document.getElementById("PatientApprovalNum")
	const ApprovalMaxLimit = document.getElementById("ApprovalMaxLimit")
	const InssuredExpireDate = document.getElementById("InssuredExpireDate")
	const DiscountCard = document.getElementById("DiscountCard")

	// Add an event listener to the checkbox to toggle input visibility
	checkbox.addEventListener("change", function () {
		if (checkbox.checked) {
			insuredCompanyInput.style.display = "block";
			CopaymentInput.style.display = "block";
			PatientInssurredId.style.display = "block";
			PatientApprovalNum.style.display = "block";
			ApprovalMaxLimit.style.display = "block";
			InssuredExpireDate.style.display = "block";
			DiscountCard.style.display = "none";
		} else {
			insuredCompanyInput.style.display = "none";
			CopaymentInput.style.display = "none";
			PatientInssurredId.style.display = "none";
			PatientApprovalNum.style.display = "none";
			ApprovalMaxLimit.style.display = "none";
			InssuredExpireDate.style.display = "none";
			DiscountCard.style.display = "block";

		}
	});
</script>


<script>
	var form = document.getElementById('kt_modal_create_app_form');
	var submitButton = document.getElementById('btn_submit');

	submitButton.addEventListener('click', function (event) {
		// Check if all required fields have values
		if (validateForm()) {
			form.submit();
		} else {
			// Prevent the default form submission
			event.preventDefault();
			// Show SweetAlert error message
			showValidationError();
		}
	});

	function validateForm() {
		// Get all elements with the 'required' attribute
		var requiredElements = form.querySelectorAll('[required]');

		// Check each required element
		for (var i = 0; i < requiredElements.length; i++) {
			var element = requiredElements[i];

			// Check if the element is an input, select, or textarea
			if (element.tagName.toLowerCase() === 'input' || element.tagName.toLowerCase() === 'select' || element.tagName.toLowerCase() === 'textarea') {
				// Check if the element has a value
				if (element.tagName.toLowerCase() === 'select') {
					// For <select> elements, check if the value is empty or equal to "add-patient" or "add-refdoc"
					if (!element.value || element.value === "add-patient" || element.value === "add-refdoc") {
						return false;
					}
				} else if (!element.value.trim()) {
					// For other input elements, check if the element value is empty
					return false;
				}
			}
		}

		// If all required fields have values, return true
		return true;
	}


	function showValidationError() {
		Swal.fire({
			icon: 'error',
			title: 'Validation Error',
			text: 'Please fill all required fields.',
		});
	}
</script>




<script>
	$(document).ready(function () {
		$("#vendorData").change(function () {
			console.log($(this).val());
			$.ajax({
				url: "/ServicesPricelist/ShowServiceInVisit?vendorId=" + $(this).val(),
				method: "GET",
				success: function (data) {
					$("#SPLTable").html(data);
				},
				error: function () {
					alert("Error loading SPL details.");
				}
			});
		});
	});
</script>

@section Scripts{
	<script src="~/plugins/custom/datatables/datatables.bundle.js"></script>
	<script src="~/plugins/custom/formrepeater/formrepeater.bundle.js"></script>
	<!--end::Vendors Javascript-->
	<!--begin::Custom Javascript(used for this page only)-->
	@*error in the next line*@
	<script src="~/js/custom/apps/ecommerce/sales/save-order.js"></script>
	<script src="~/js/widgets.bundle.js"></script>
	<script src="~/js/custom/widgets.js"></script>
	<script src="~/js/custom/apps/chat/chat.js"></script>
	<script src="~/js/custom/utilities/modals/upgrade-plan.js"></script>
	<script src="~/js/custom/utilities/modals/create-app.js"></script>
	<script src="~/js/custom/utilities/modals/users-search.js"></script>
		}